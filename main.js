!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn-disabled",inputErrorClass:"modal__input_type-error",errorClass:"modal__error_visible"},r=(e,r)=>{const n=r.id+"-error";e.querySelector("#"+n).textContent="",r.classList.remove(t.inputErrorClass)},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},o=(e,r)=>{var o,a;(e=>e.some((e=>!e.validity.valid)))(e)?n(r,t):(a=t,(o=r).disabled=!1,o.classList.remove(a.inactiveButtonClass))};function a(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Save";e.textContent=t?r:n}var s=e+"d3610e9c6dce3cb370d8.svg",c=e+"04c411e519a1c6561568.jpg",i=e+"1ecf96fab54a91c898b4.svg",l=e+"40608da7369d39bc1077.svg",d=e+"d73f076c46eb5467f5fc.svg";const u=document.querySelector("#edit-profile-btn"),m=document.querySelector("#edit-profile-modal"),_=m.querySelector(".modal__form"),h=document.querySelector("#add-card-modal"),v=document.querySelector(".profile__new-post"),f=document.forms["add-card-form"],p=h.querySelector(".modal__submit-btn"),y=h.querySelector("#add-card-name-input"),b=h.querySelector("#add-card-link-input"),S=document.querySelector(".profile__name"),g=document.querySelector(".profile__description"),q=m.querySelector("#profile-name-input"),E=m.querySelector("#profile-description-input"),k=document.querySelector("#avatar-modal"),L=document.querySelector(".profile__avatar-btn"),C=document.forms["avatar-form"],I=k.querySelector("#profile-avatar-input"),U=document.querySelector("#card-template"),x=document.querySelector(".cards__list"),A=document.querySelector("#preview-modal"),P=A.querySelector(".modal__image"),B=A.querySelector(".modal__caption"),$=document.querySelector("#delete-modal"),D=$.querySelector("#delete-cancel-btn"),T=$.querySelector(".modal__form");let w,j;const N=document.querySelectorAll(".modal__close-btn");document.getElementById("headerLogo").src=s;const O=document.getElementById("profileAvatar");O.src=c,document.getElementById("profilePencil").src=i,document.getElementById("profilePlusSign").src=l,document.getElementById("hoverEditPencil").src=d;const J=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}request(e,t){return fetch(e,t).then(this.checkResponse)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return this.request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this.request(`${this._baseUrl}/users/me`,{headers:this._headers})}editUserInfo(e){let{name:t,about:r}=e;return this.request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})})}editAvatarInfo(e){return this.request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}removeCard(e){return this.request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}addCard(e){let{name:t,link:r}=e;return this.request(`${this._baseUrl}/cards/`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})})}toggleLike(e,t){return this.request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9e68d7b8-65ac-4026-8ffb-a48d38eaf0d6","Content-Type":"application/json"}});function H(e){e.classList.add("modal_opened"),e.addEventListener("click",M),document.addEventListener("keydown",z)}function R(e){e.classList.remove("modal_opened"),e.removeEventListener("click",M),document.removeEventListener("keydown",z)}function z(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&R(e)}}function M(e){e.target.classList.contains("modal_opened")&&R(e.target)}function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";const r=function(e){const t=U.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return r.textContent=e.name,n.alt=e.name,n.src=e.link,e.isLiked&&o.classList.add("card__like-btn_liked"),o.addEventListener("click",(()=>{o.classList.contains("card__like-btn_liked")?J.toggleLike(e._id,!0).then((()=>{o.classList.toggle("card__like-btn_liked")})).catch(console.error):J.toggleLike(e._id,!1).then((()=>{o.classList.toggle("card__like-btn_liked")})).catch(console.error)})),a.addEventListener("click",(()=>function(e,t){w=e,j=t,H($)}(t,e._id))),n.addEventListener("click",(t=>{t.stopPropagation(),H(A),P.alt=e.name,P.src=e.link,B.textContent=e.name})),t}(e);x[t](r)}var G;J.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{F(e)})),S.textContent=r.name,g.textContent=r.about,O.src=r.avatar})).catch(console.error),T.addEventListener("submit",(function(e){const t=e.submitter;a(t,!0),e.preventDefault(),J.removeCard(j).then((()=>{w.remove(),R($)})).catch(console.error).finally((()=>{a(t,!1,"Deleting...","Delete")}))})),u.addEventListener("click",(()=>{var e;q.value=S.textContent,E.value=g.textContent,e=_,[q,E].forEach((t=>{r(e,t)})),H(m)})),_.addEventListener("submit",(function(e){const t=e.submitter;a(t,!0),e.preventDefault(),J.editUserInfo({name:q.value,about:E.value}).then((e=>{S.textContent=e.name,g.textContent=e.about,R(m)})).catch(console.error).finally((()=>{a(t,!1)}))})),f.addEventListener("submit",(function(e){const r=e.submitter;a(r,!0),e.preventDefault(),J.addCard({name:y.value,link:b.value}).then((r=>{F(r),e.target.reset(),n(p,t),R(h)})).catch(console.error).finally((()=>{a(r,!1)}))})),C.addEventListener("submit",(function(e){const t=e.submitter;a(t,!0),e.preventDefault(),J.editAvatarInfo(I.value).then((e=>{e.avatar&&(O.src=e.avatar,O.alt=S.textContent),R(k)})).catch(console.error).finally((()=>{a(t,!1)}))})),v.addEventListener("click",(e=>{e.stopPropagation(),H(h)})),D.addEventListener("click",(()=>{R($)})),L.addEventListener("click",(()=>{H(k)})),N.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>{R(t)}))})),G=t,document.querySelectorAll(G.formSelector).forEach((e=>{((e,n)=>{const a=Array.from(e.querySelectorAll(n.inputSelector)),s=e.querySelector(n.submitButtonSelector);o(a,s),a.forEach((n=>{n.addEventListener("input",(function(){((e,n)=>{n.validity.valid?r(e,n):((e,r,n)=>{const o=r.id+"-error";e.querySelector("#"+o).textContent=n,r.classList.add(t.inputErrorClass)})(e,n,n.validationMessage)})(e,n),o(a,s)}))}))})(e,G)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0JySyxFQUFPSSxjQUFjTSxFQUFPZixzQkFDbERrQixFQUFrQkMsRUFBV3VKLEdBRTdCdkosRUFBVXFJLFNBQVNtQixJQUNmQSxFQUFhckQsaUJBQWlCLFNBQVMsV0E5Q3BCc0QsRUFBQ3ZLLEVBQVFDLEtBQzNCQSxFQUFRa0IsU0FBU0MsTUFHbEJyQixFQUFlQyxFQUFRQyxHQWxCUnVLLEVBQUN4SyxFQUFRQyxFQUFTd0ssS0FDckMsTUFBTXZLLEVBQWFELEVBQVFFLEdBQUssU0FDYkgsRUFBT0ksY0FBYyxJQUFNRixHQUNuQ0csWUFBY29LLEVBQ3pCeEssRUFBUUssVUFBVU0sSUFBSXBCLEVBQVNLLGdCQUFnQixFQVkzQzJLLENBQWV4SyxFQUFRQyxFQUFTQSxFQUFReUssa0JBRzVDLEVBMENRSCxDQUFtQnZLLEVBQVFzSyxHQUMzQnpKLEVBQWtCQyxFQUFXdUosRUFDakMsR0FBRSxHQUNKLEVBT0VILENBQWtCbEssRUFBUVUsRUFBTyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvaGVscGVycy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuLWRpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGUtZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIlxyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZykgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JNc2dJRCA9IGlucHV0RWwuaWQgKyBcIi1lcnJvclwiO1xyXG4gICAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JNc2dJRCk7XHJcbiAgICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gZXJyb3JNc2c7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCkgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JNc2dJRCA9IGlucHV0RWwuaWQgKyBcIi1lcnJvclwiO1xyXG4gICAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JNc2dJRCk7XHJcbiAgICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbCwgaW5wdXRFbCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgICAgICByZXR1cm4gIWlucHV0LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCkgPT4ge1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG5leHBvcnQgY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b24sIGNvbmZpZykgPT4ge1xyXG4gICAgYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGVuYWJsZUJ1dHRvbiA9IChidXR0b24sIGNvbmZpZykgPT4ge1xyXG4gICAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsKSA9PiB7XHJcbiAgICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgICAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsLCBzZXR0aW5ncyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGVuYWJsZUJ1dHRvbihidXR0b25FbCwgc2V0dGluZ3MpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcclxuXHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWwsIGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICAgIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcclxuICAgIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xyXG4gICAgICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG5cclxufTtcclxuXHJcblxyXG4iLCJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChidG4sIGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiLCBkZWZhdWx0VGV4dCA9IFwiU2F2ZVwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgICAgYnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJ0bi50ZXh0Q29udGVudCA9IGRlZmF1bHRUZXh0O1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiwgc2V0dGluZ3MsIGRpc2FibGVCdXR0b24sIHJlc2V0VmFsaWRhdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIlxyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiXHJcbmltcG9ydCB7IHNldEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vdXRpbHMvaGVscGVycy5qc1wiXHJcbmltcG9ydCBoZWFkZXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiXHJcbmltcG9ydCBhdmF0YXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCJcclxuaW1wb3J0IHBlbmNpbFNyYyBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC5zdmdcIlxyXG5pbXBvcnQgcGx1c1NyYyBmcm9tIFwiLi4vaW1hZ2VzL3BsdXMtc2lnbi5zdmdcIlxyXG5pbXBvcnQgbGlnaHRQZW5jaWwgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwtbGlnaHQuc3ZnXCJcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCJcclxuXHJcblxyXG4vKiBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCJcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCJcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJBIHN1bm55IGJyaWRnZVwiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIlxyXG4gICAgfSxcclxuXTsgKi9cclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtYnRuXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcblxyXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBhZGRDYXJkTmV3UG9zdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmV3LXBvc3RcIik7XHJcbmNvbnN0IGNhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdO1xyXG5jb25zdCBjYXJkU3VibWl0QnV0dG9uID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XHJcbmNvbnN0IGNhcmROYW1lSW5wdXQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBjYXJkTGlua0lucHV0ID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZU5hbWUgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZURlc2NyaXB0aW9uID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIik7XHJcblxyXG4vL2F2YXRhciBlbGVtZW50c1xyXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyLWZvcm1cIl07XHJcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbi8vcHJldmlldyBtb2RhbCBlbGVtZW50c1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdJbWcgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdDYXAgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuXHJcbi8vZGVsZXRlIG1vZGFsIGVsZW1lbnRzXHJcbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XHJcbmNvbnN0IGRlbGV0ZUNhbmNlbEJ0biA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhbmNlbC1idG5cIik7XHJcbmNvbnN0IGRlbGV0ZVN1Ym1pdEZvcm0gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5sZXQgc2VsZWN0Q2FyZDtcclxubGV0IHNlbGVjdGVkQ2FyZElkO1xyXG5cclxuLy91bml2ZXJzYWwgY2xvc2UgYnV0dG9uXHJcbmNvbnN0IGNsb3NlQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuXHJcbi8vaW1hZ2UgcHJvZmlsZSBzcmMgZWxlbWVudHNcclxuY29uc3QgaGVhZGVySW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJoZWFkZXJMb2dvXCIpO1xyXG5oZWFkZXJJbWcuc3JjID0gaGVhZGVyU3JjO1xyXG5jb25zdCBhdmF0ZXJJbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVBdmF0YXJcIik7XHJcbmF2YXRlckltZy5zcmMgPSBhdmF0YXJTcmM7XHJcbmNvbnN0IHBlbmNpbEltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZVBlbmNpbFwiKTtcclxucGVuY2lsSW1nLnNyYyA9IHBlbmNpbFNyYztcclxuY29uc3QgcGx1c0ltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZVBsdXNTaWduXCIpO1xyXG5wbHVzSW1nLnNyYyA9IHBsdXNTcmM7XHJcbmNvbnN0IHByb2ZpbGVFZGl0SG92ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhvdmVyRWRpdFBlbmNpbFwiKTtcclxucHJvZmlsZUVkaXRIb3Zlci5zcmMgPSBsaWdodFBlbmNpbDtcclxuXHJcbi8vIEFQSSBcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI5ZTY4ZDdiOC02NWFjLTQwMjYtOGZmYi1hNDhkMzhlYWYwZDZcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgfVxyXG59KTtcclxuXHJcbmFwaS5nZXRBcHBJbmZvKClcclxuICAgIC50aGVuKChbY2FyZHMsIHVzZXJzXSkgPT4ge1xyXG4gICAgICAgIGNhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgcmVuZGVyQ2FyZChpdGVtKTtcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJzLm5hbWU7XHJcbiAgICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlcnMuYWJvdXQ7XHJcbiAgICAgICAgYXZhdGVySW1nLnNyYyA9IHVzZXJzLmF2YXRhcjtcclxuXHJcblxyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTsgLy8gbm90ZSA6IHBhc3NpbmcgZnVuYyBhcyBhIHBhcmVtIHdpbGwgdGFrZSB0aGUgZmlyc3QgdmFsdWUgYXMgdGhlIHBhcmVtIG9mIHRoZSBmdW5jdGlvbi4gXHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheSk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXkpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRXNjYXBlKGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxPcGVuZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgICAgICBpZiAobW9kYWxPcGVuZWQpIHtcclxuICAgICAgICAgICAgY2xvc2VNb2RhbChtb2RhbE9wZW5lZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVPdmVybGF5KGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xyXG4gICAgICAgIGNsb3NlTW9kYWwoZXZlbnQudGFyZ2V0KTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgICBjb25zdCBlZGl0Rm9ybVN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgICBzZXRCdXR0b25UZXh0KGVkaXRGb3JtU3VibWl0QnRuLCB0cnVlKTtcclxuXHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGFwaS5lZGl0VXNlckluZm8oeyBuYW1lOiBlZGl0UHJvZmlsZU5hbWUudmFsdWUsIGFib3V0OiBlZGl0UHJvZmlsZURlc2NyaXB0aW9uLnZhbHVlIH0pXHJcbiAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICAgICAgICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHNldEJ1dHRvblRleHQoZWRpdEZvcm1TdWJtaXRCdG4sIGZhbHNlKTtcclxuICAgICAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChpdGVtLCBtZXRob2QgPSBcInByZXBlbmRcIikge1xyXG4gICAgY29uc3QgY2FyZEVsID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XHJcbiAgICBjYXJkc0xpc3RbbWV0aG9kXShjYXJkRWwpO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcclxuICAgIGNvbnN0IGFkZENhcmRTdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gICAgc2V0QnV0dG9uVGV4dChhZGRDYXJkU3VibWl0QnRuLCB0cnVlKTtcclxuXHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGFwaS5hZGRDYXJkKHsgbmFtZTogY2FyZE5hbWVJbnB1dC52YWx1ZSwgbGluazogY2FyZExpbmtJbnB1dC52YWx1ZSB9KVxyXG4gICAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICAgICAgICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcclxuICAgICAgICAgICAgY2xvc2VNb2RhbChhZGRDYXJkTW9kYWwpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRCdXR0b25UZXh0KGFkZENhcmRTdWJtaXRCdG4sIGZhbHNlKTtcclxuICAgICAgICB9KTtcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcclxuICAgIGNvbnN0IGF2YXRhclN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgICBzZXRCdXR0b25UZXh0KGF2YXRhclN1Ym1pdEJ0biwgdHJ1ZSk7XHJcblxyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBhcGkuZWRpdEF2YXRhckluZm8oYXZhdGFySW5wdXQudmFsdWUpXHJcbiAgICAgICAgLnRoZW4oKGF2YXRhckRhdGEpID0+IHtcclxuICAgICAgICAgICAgaWYgKGF2YXRhckRhdGEuYXZhdGFyKSB7XHJcbiAgICAgICAgICAgICAgICBhdmF0ZXJJbWcuc3JjID0gYXZhdGFyRGF0YS5hdmF0YXI7XHJcbiAgICAgICAgICAgICAgICBhdmF0ZXJJbWcuYWx0ID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRCdXR0b25UZXh0KGF2YXRhclN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVCdG4oY2FyZEVsZW1lbnQsIGNhcmRJZCkge1xyXG4gICAgc2VsZWN0Q2FyZCA9IGNhcmRFbGVtZW50O1xyXG4gICAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XHJcbiAgICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XHJcbiAgICBjb25zdCBkZWxldGVTdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gICAgc2V0QnV0dG9uVGV4dChkZWxldGVTdWJtaXRCdG4sIHRydWUpO1xyXG5cclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgYXBpLnJlbW92ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBzZWxlY3RDYXJkLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgc2V0QnV0dG9uVGV4dChkZWxldGVTdWJtaXRCdG4sIGZhbHNlLCBcIkRlbGV0aW5nLi4uXCIsIFwiRGVsZXRlXCIpO1xyXG4gICAgICAgIH0pO1xyXG59O1xyXG5cclxuZGVsZXRlU3VibWl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcblxyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgY29uc3QgY2FyZE5hbWVFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIGNvbnN0IGltZ0VsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xyXG4gICAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcclxuXHJcblxyXG4gICAgY2FyZE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgaW1nRWxlbWVudC5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBpbWdFbGVtZW50LnNyYyA9IGRhdGEubGluaztcclxuXHJcbiAgICBpZiAoZGF0YS5pc0xpa2VkKSB7XHJcbiAgICAgICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGlmIChjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKSkge1xyXG4gICAgICAgICAgICBhcGkudG9nZ2xlTGlrZShkYXRhLl9pZCwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIilcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYXBpLnRvZ2dsZUxpa2UoZGF0YS5faWQsIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBoYW5kbGVEZWxldGVCdG4oY2FyZEVsZW1lbnQsIGRhdGEuX2lkKSk7XHJcblxyXG4gICAgaW1nRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuICAgICAgICBwcmV2aWV3SW1nLmFsdCA9IGRhdGEubmFtZTtcclxuICAgICAgICBwcmV2aWV3SW1nLnNyYyA9IGRhdGEubGluaztcclxuICAgICAgICBwcmV2aWV3Q2FwLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgZWRpdFByb2ZpbGVOYW1lLnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgICBlZGl0UHJvZmlsZURlc2NyaXB0aW9uLnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gICAgcmVzZXRWYWxpZGF0aW9uKGVkaXRGb3JtRWxlbWVudCwgW2VkaXRQcm9maWxlTmFtZSwgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbl0pO1xyXG4gICAgb3Blbk1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG59KTtcclxuXHJcbmVkaXRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRGb3JtU3VibWl0KTtcclxuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcclxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XHJcblxyXG5hZGRDYXJkTmV3UG9zdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgb3Blbk1vZGFsKGFkZENhcmRNb2RhbCk7XHJcbn0pO1xyXG5cclxuZGVsZXRlQ2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufSk7XHJcblxyXG5hdmF0YXJNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG5jbG9zZUJ0bnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgICBjb25zdCBwb3B1cCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xyXG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgY2xvc2VNb2RhbChwb3B1cCk7XHJcbiAgICB9KVxyXG59KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJcclxuY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5jaGVja1Jlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRBcHBJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXQsXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVkaXRBdmF0YXJJbmZvKGF2YXRhcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUNhcmQoY2FyZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2AsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIGxpbmssXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUxpa2UoaWQsIGlzTGlrZWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpOyJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsIiwiaW5wdXRFbCIsImVycm9yTXNnSUQiLCJpZCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImRpc2FibGVCdXR0b24iLCJidXR0b24iLCJjb25maWciLCJkaXNhYmxlZCIsImFkZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWwiLCJlbmFibGVCdXR0b24iLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0Iiwic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiZGVmYXVsdFRleHQiLCJwcm9maWxlRWRpdEJ0biIsImRvY3VtZW50IiwiZWRpdFByb2ZpbGVNb2RhbCIsImVkaXRGb3JtRWxlbWVudCIsImFkZENhcmRNb2RhbCIsImFkZENhcmROZXdQb3N0IiwiY2FyZEZvcm0iLCJmb3JtcyIsImNhcmRTdWJtaXRCdXR0b24iLCJjYXJkTmFtZUlucHV0IiwiY2FyZExpbmtJbnB1dCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwiZWRpdFByb2ZpbGVOYW1lIiwiZWRpdFByb2ZpbGVEZXNjcmlwdGlvbiIsImF2YXRhck1vZGFsIiwiYXZhdGFyTW9kYWxCdG4iLCJhdmF0YXJGb3JtIiwiYXZhdGFySW5wdXQiLCJjYXJkVGVtcGxhdGUiLCJjYXJkc0xpc3QiLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3SW1nIiwicHJldmlld0NhcCIsImRlbGV0ZU1vZGFsIiwiZGVsZXRlQ2FuY2VsQnRuIiwiZGVsZXRlU3VibWl0Rm9ybSIsInNlbGVjdENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImNsb3NlQnRucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJnZXRFbGVtZW50QnlJZCIsInNyYyIsImhlYWRlclNyYyIsImF2YXRlckltZyIsImF2YXRhclNyYyIsInBlbmNpbFNyYyIsInBsdXNTcmMiLCJsaWdodFBlbmNpbCIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJjaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsInJlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0QXBwSW5mbyIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRBdmF0YXJJbmZvIiwiYXZhdGFyIiwicmVtb3ZlQ2FyZCIsImNhcmQiLCJhZGRDYXJkIiwiX3JlZjMiLCJsaW5rIiwidG9nZ2xlTGlrZSIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwib3Blbk1vZGFsIiwibW9kYWwiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlT3ZlcmxheSIsImhhbmRsZUVzY2FwZSIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJtb2RhbE9wZW5lZCIsInRhcmdldCIsImNvbnRhaW5zIiwicmVuZGVyQ2FyZCIsIml0ZW0iLCJjYXJkRWwiLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbGVtZW50IiwiaW1nRWxlbWVudCIsImNhcmRMaWtlQnRuIiwiY2FyZERlbGV0ZUJ0biIsImFsdCIsIl9pZCIsInRvZ2dsZSIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiY2FyZElkIiwiaGFuZGxlRGVsZXRlQnRuIiwiZXZ0Iiwic3RvcFByb3BhZ2F0aW9uIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkcyIsInVzZXJzIiwiZm9yRWFjaCIsImRlbGV0ZVN1Ym1pdEJ0biIsInN1Ym1pdHRlciIsInByZXZlbnREZWZhdWx0IiwiZmluYWxseSIsInJlc2V0VmFsaWRhdGlvbiIsInZhbHVlIiwiZWRpdEZvcm1TdWJtaXRCdG4iLCJhZGRDYXJkU3VibWl0QnRuIiwiY2FyZERhdGEiLCJyZXNldCIsImF2YXRhclN1Ym1pdEJ0biIsImF2YXRhckRhdGEiLCJwb3B1cCIsImNsb3Nlc3QiLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImJ1dHRvbkVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTXNnIiwidmFsaWRhdGlvbk1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9