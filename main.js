!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn-disabled",inputErrorClass:"modal__input_type-error",errorClass:"modal__error_visible"},r=(e,r)=>{const o=r.id+"-error";e.querySelector("#"+o).textContent="",r.classList.remove(t.inputErrorClass)},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},n=(e,r)=>{var n,a;(e=>e.some((e=>!e.validity.valid)))(e)?o(r,t):(a=t,(n=r).disabled=!1,n.classList.remove(a.inactiveButtonClass))};function a(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Save";e.textContent=t?r:o}var s=e+"d3610e9c6dce3cb370d8.svg",c=e+"04c411e519a1c6561568.jpg",i=e+"1ecf96fab54a91c898b4.svg",l=e+"40608da7369d39bc1077.svg",d=e+"d73f076c46eb5467f5fc.svg";const u=document.querySelector("#edit-profile-btn"),m=document.querySelector("#edit-profile-modal"),f=m.querySelector("#edit-profile-close-btn"),_=m.querySelector(".modal__form"),v=document.querySelector("#add-card-modal"),h=document.querySelector(".profile__new-post"),p=v.querySelector("#add-card-close-btn"),y=v.querySelector(".modal__form"),b=v.querySelector(".modal__submit-btn"),S=v.querySelector("#add-card-name-input"),E=v.querySelector("#add-card-link-input"),g=document.querySelector(".profile__name"),k=document.querySelector(".profile__description"),q=m.querySelector("#profile-name-input"),L=m.querySelector("#profile-description-input"),C=document.querySelector("#avatar-modal"),P=document.querySelector(".profile__avatar-btn"),j=C.querySelector("#edit-profile-close-btn"),$=C.querySelector("#edit-avatar-form"),I=C.querySelector("#profile-avatar-input"),U=m.querySelector(".modal__form"),x=document.querySelector("#card-template"),A=document.querySelector(".cards__list"),B=document.querySelector("#preview-modal"),D=B.querySelector("#prview-close-btn"),T=B.querySelector(".modal__image"),w=B.querySelector(".modal__caption"),N=document.querySelector("#delete-modal"),O=N.querySelector("#delete-cancel-btn"),J=N.querySelector(".modal__form");let H,z;document.getElementById("headerLogo").src=s;const M=document.getElementById("profileAvatar");M.src=c,document.getElementById("profilePencil").src=i,document.getElementById("profilePlusSign").src=l,document.getElementById("hoverEditPencil").src=d;const F=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards/`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}toggleLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9e68d7b8-65ac-4026-8ffb-a48d38eaf0d6","Content-Type":"application/json"}});function G(e){e.classList.add("modal_opened"),e.addEventListener("click",R),document.addEventListener("keydown",Q)}function K(e){e.classList.remove("modal_opened"),e.removeEventListener("click",R),document.removeEventListener("keydown",Q)}function Q(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&K(e)}}function R(e){e.target.classList.contains("modal_opened")&&K(e.target)}function V(e){const t=x.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return r.textContent=e.name,o.alt=e.name,o.src=e.link,e.isLiked&&n.classList.add("card__like-btn_liked"),n.addEventListener("click",(()=>{n.classList.contains("card__like-btn_liked")?F.toggleLike(e._id,!0).then(n.classList.toggle("card__like-btn_liked")):(F.toggleLike(e._id,!1).then(n.classList.toggle("card__like-btn_liked")),console.log(e._id))})),a.addEventListener("click",(()=>function(e,t){H=e,z=t,G(N)}(t,e._id))),o.addEventListener("click",(t=>{t.stopPropagation(),G(B),T.alt=e.name,T.src=e.link,w.textContent=e.name})),t}var W;F.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{const t=V(e);A.prepend(t)})),g.textContent=r.name,k.textContent=r.about,M.src=r.avatar})).catch(console.error),J.addEventListener("submit",(function(e){const t=e.submitter;a(t,!0),e.preventDefault(),F.removeCard(z).then((()=>{H.remove(),K(N)})).catch(console.error).finally((()=>{a(t,!1,"Deleting...","Delete")}))})),u.addEventListener("click",(()=>{var e;q.value=g.textContent,L.value=k.textContent,e=_,[q,L].forEach((t=>{r(e,t)})),G(m)})),f.addEventListener("click",(()=>{K(m)})),U.addEventListener("submit",(function(e){const t=e.submitter;a(t,!0),e.preventDefault(),F.editUserInfo({name:q.value,about:L.value}).then((e=>{g.textContent=e.name,k.textContent=e.about,K(m)})).catch(console.error).finally((()=>{a(t,!1)}))})),y.addEventListener("submit",(function(e){const r=e.submitter;a(r,!0),e.preventDefault(),F.addCard({name:S.value,link:E.value}).then((e=>{!function(e){const t=V(e);A.prepend(t)}(e),o(b,t),K(v)})).catch(console.error).finally((()=>{a(r,!1)}))})),$.addEventListener("submit",(function(e){const t=e.submitter;a(t,!0),e.preventDefault(),F.editAvatarInfo(I.value).then((e=>{e.avatar&&(M.src=e.avatar,console.log(e.avatar),M.alt="updated avatar"),K(C)})).catch(console.error).finally((()=>{a(t,!1)}))})),h.addEventListener("click",(e=>{e.stopPropagation(),G(v)})),p.addEventListener("click",(()=>{K(v)})),O.addEventListener("click",(()=>{K(N)})),P.addEventListener("click",(()=>{G(C)})),j.addEventListener("click",(()=>{K(C)})),D.addEventListener("click",(()=>{K(B)})),W=t,document.querySelectorAll(W.formSelector).forEach((e=>{((e,o)=>{const a=Array.from(e.querySelectorAll(o.inputSelector)),s=e.querySelector(o.submitButtonSelector);n(a,s),a.forEach((o=>{o.addEventListener("input",(function(){((e,o)=>{o.validity.valid?r(e,o):((e,r,o)=>{const n=r.id+"-error";e.querySelector("#"+n).textContent=o,r.classList.add(t.inputErrorClass)})(e,o,o.validationMessage)})(e,o),n(a,s)}))}))})(e,W)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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InNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bi1kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlLWVycm9yXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCJcclxufTtcclxuXHJcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgZXJyb3JNc2cpID0+IHtcclxuICAgIGNvbnN0IGVycm9yTXNnSUQgPSBpbnB1dEVsLmlkICsgXCItZXJyb3JcIjtcclxuICAgIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTXNnSUQpO1xyXG4gICAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwpID0+IHtcclxuICAgIGNvbnN0IGVycm9yTXNnSUQgPSBpbnB1dEVsLmlkICsgXCItZXJyb3JcIjtcclxuICAgIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTXNnSUQpO1xyXG4gICAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwpID0+IHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XHJcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XHJcbiAgICAgICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG5cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsLCBpbnB1dExpc3QpID0+IHtcclxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uLCBjb25maWcpID0+IHtcclxuICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBidXR0b24uY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBlbmFibGVCdXR0b24gPSAoYnV0dG9uLCBjb25maWcpID0+IHtcclxuICAgIGJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCkgPT4ge1xyXG4gICAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICAgICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbCwgc2V0dGluZ3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBlbmFibGVCdXR0b24oYnV0dG9uRWwsIHNldHRpbmdzKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbCwgY29uZmlnKSA9PiB7XHJcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XHJcblxyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWwsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxuXHJcbn07XHJcblxyXG5cclxuIiwiZXhwb3J0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoYnRuLCBpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIiwgZGVmYXVsdFRleHQgPSBcIlNhdmVcIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICAgIGJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBidG4udGV4dENvbnRlbnQgPSBkZWZhdWx0VGV4dDtcclxuICAgIH1cclxufSIsImltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIHNldHRpbmdzLCBkaXNhYmxlQnV0dG9uLCByZXNldFZhbGlkYXRpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCJcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIlxyXG5pbXBvcnQgeyBzZXRCdXR0b25UZXh0IH0gZnJvbSBcIi4uL3V0aWxzL2hlbHBlcnMuanNcIlxyXG5pbXBvcnQgaGVhZGVyU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIlxyXG5pbXBvcnQgYXZhdGFyU3JjIGZyb20gXCIuLi9pbWFnZXMvYXZhdGFyLmpwZ1wiXHJcbmltcG9ydCBwZW5jaWxTcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwuc3ZnXCJcclxuaW1wb3J0IHBsdXNTcmMgZnJvbSBcIi4uL2ltYWdlcy9wbHVzLXNpZ24uc3ZnXCJcclxuaW1wb3J0IGxpZ2h0UGVuY2lsIGZyb20gXCIuLi9pbWFnZXMvcGVuY2lsLWxpZ2h0LnN2Z1wiXHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiXHJcblxyXG5cclxuLyogY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCJcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiQW4gb3V0ZG9vciBjYWZlXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxyXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiBcIk1vdW50YWluIGhvdXNlXCIsXHJcbiAgICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6IFwiQSBzdW5ueSBicmlkZ2VcIixcclxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCJcclxuICAgIH0sXHJcbl07ICovXHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWJ0blwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlQ2xvc2VCdG4gPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWNsb3NlLWJ0blwiKTtcclxuY29uc3QgZWRpdE1vZGFsID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5cclxuY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcclxuY29uc3QgYWRkQ2FyZE5ld1Bvc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25ldy1wb3N0XCIpO1xyXG5jb25zdCBhZGRDYXJkQ2xvc2VCdG4gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1jbG9zZS1idG5cIik7XHJcbmNvbnN0IGNhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGNhcmRTdWJtaXRCdXR0b24gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcclxuY29uc3QgY2FyZE5hbWVJbnB1dCA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rLWlucHV0XCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlTmFtZSA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlRGVzY3JpcHRpb24gPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuXHJcbi8vYXZhdGFyIGVsZW1lbnRzXHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJDbG9zZUJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWNsb3NlLWJ0blwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItZm9ybVwiKTtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYXZhdGFyLWlucHV0XCIpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5cclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxuLy9wcmV2aWV3IG1vZGFsIGVsZW1lbnRzXHJcbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcclxuY29uc3QgcHJldmlld01vZGFsQ2xvc2VCdG4gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcnZpZXctY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBwcmV2aWV3SW1nID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG5jb25zdCBwcmV2aWV3Q2FwID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcblxyXG4vL2RlbGV0ZSBtb2RhbCBlbGVtZW50c1xyXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVDYW5jZWxCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYW5jZWwtYnRuXCIpO1xyXG5jb25zdCBkZWxldGVTdWJtaXRGb3JtID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxubGV0IHNlbGVjdENhcmQ7XHJcbmxldCBzZWxlY3RlZENhcmRJZDtcclxuXHJcbi8vaW1hZ2UgcHJvZmlsZSBzcmMgZWxlbWVudHNcclxuY29uc3QgaGVhZGVySW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJoZWFkZXJMb2dvXCIpO1xyXG5oZWFkZXJJbWcuc3JjID0gaGVhZGVyU3JjO1xyXG5jb25zdCBhdmF0ZXJJbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGVBdmF0YXJcIik7XHJcbmF2YXRlckltZy5zcmMgPSBhdmF0YXJTcmM7XHJcbmNvbnN0IHBlbmNpbEltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZVBlbmNpbFwiKTtcclxucGVuY2lsSW1nLnNyYyA9IHBlbmNpbFNyYztcclxuY29uc3QgcGx1c0ltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZVBsdXNTaWduXCIpO1xyXG5wbHVzSW1nLnNyYyA9IHBsdXNTcmM7XHJcbmNvbnN0IHByb2ZpbGVFZGl0SG92ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhvdmVyRWRpdFBlbmNpbFwiKTtcclxucHJvZmlsZUVkaXRIb3Zlci5zcmMgPSBsaWdodFBlbmNpbDtcclxuXHJcbi8vIEFQSSBcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI5ZTY4ZDdiOC02NWFjLTQwMjYtOGZmYi1hNDhkMzhlYWYwZDZcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgfVxyXG59KTtcclxuXHJcbmFwaS5nZXRBcHBJbmZvKClcclxuICAgIC50aGVuKChbY2FyZHMsIHVzZXJzXSkgPT4ge1xyXG4gICAgICAgIGNhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcclxuICAgICAgICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlcnMubmFtZTtcclxuICAgICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2Vycy5hYm91dDtcclxuICAgICAgICBhdmF0ZXJJbWcuc3JjID0gdXNlcnMuYXZhdGFyO1xyXG5cclxuXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpOyAvLyBub3RlIDogcGFzc2luZyBmdW5jIGFzIGEgcGFyZW0gd2lsbCB0YWtlIHRoZSBmaXJzdCB2YWx1ZSBhcyB0aGUgcGFyZW0gb2YgdGhlIGZ1bmN0aW9uLiBcclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVPdmVybGF5KTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheSk7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICBjb25zdCBtb2RhbE9wZW5lZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgICAgIGlmIChtb2RhbE9wZW5lZCkge1xyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKG1vZGFsT3BlbmVkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU92ZXJsYXkoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XHJcbiAgICAgICAgY2xvc2VNb2RhbChldmVudC50YXJnZXQpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdChldnQpIHtcclxuICAgIGNvbnN0IGVkaXRGb3JtU3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcclxuICAgIHNldEJ1dHRvblRleHQoZWRpdEZvcm1TdWJtaXRCdG4sIHRydWUpO1xyXG5cclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgYXBpLmVkaXRVc2VySW5mbyh7IG5hbWU6IGVkaXRQcm9maWxlTmFtZS52YWx1ZSwgYWJvdXQ6IGVkaXRQcm9maWxlRGVzY3JpcHRpb24udmFsdWUgfSlcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgICAgICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgICAgICAgICAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgc2V0QnV0dG9uVGV4dChlZGl0Rm9ybVN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0pIHtcclxuICAgIGNvbnN0IGNhcmRFbCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xyXG4gICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsKTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZXZ0KSB7XHJcbiAgICBjb25zdCBhZGRDYXJkU3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcclxuICAgIHNldEJ1dHRvblRleHQoYWRkQ2FyZFN1Ym1pdEJ0biwgdHJ1ZSk7XHJcblxyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBhcGkuYWRkQ2FyZCh7IG5hbWU6IGNhcmROYW1lSW5wdXQudmFsdWUsIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUgfSlcclxuICAgICAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgICAgICAgcmVuZGVyQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgICAgICAgIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKGFkZENhcmRNb2RhbCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHNldEJ1dHRvblRleHQoYWRkQ2FyZFN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xyXG4gICAgY29uc3QgYXZhdGFyU3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcclxuICAgIHNldEJ1dHRvblRleHQoYXZhdGFyU3VibWl0QnRuLCB0cnVlKTtcclxuXHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGFwaS5lZGl0QXZhdGFySW5mbyhhdmF0YXJJbnB1dC52YWx1ZSlcclxuICAgICAgICAudGhlbigoYXZhdGFyRGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoYXZhdGFyRGF0YS5hdmF0YXIpIHtcclxuICAgICAgICAgICAgICAgIGF2YXRlckltZy5zcmMgPSBhdmF0YXJEYXRhLmF2YXRhcjtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGF2YXRhckRhdGEuYXZhdGFyKTtcclxuICAgICAgICAgICAgICAgIGF2YXRlckltZy5hbHQgPSBcInVwZGF0ZWQgYXZhdGFyXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBzZXRCdXR0b25UZXh0KGF2YXRhclN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVCdG4oY2FyZEVsZW1lbnQsIGNhcmRJZCkge1xyXG4gICAgc2VsZWN0Q2FyZCA9IGNhcmRFbGVtZW50O1xyXG4gICAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XHJcbiAgICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XHJcbiAgICBjb25zdCBkZWxldGVTdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gICAgc2V0QnV0dG9uVGV4dChkZWxldGVTdWJtaXRCdG4sIHRydWUpO1xyXG5cclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgYXBpLnJlbW92ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBzZWxlY3RDYXJkLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgc2V0QnV0dG9uVGV4dChkZWxldGVTdWJtaXRCdG4sIGZhbHNlLCBcIkRlbGV0aW5nLi4uXCIsIFwiRGVsZXRlXCIpO1xyXG4gICAgICAgIH0pO1xyXG59O1xyXG5cclxuZGVsZXRlU3VibWl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcblxyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgY29uc3QgY2FyZE5hbWVFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIGNvbnN0IGltZ0VsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xyXG4gICAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcclxuXHJcblxyXG4gICAgY2FyZE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgaW1nRWxlbWVudC5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBpbWdFbGVtZW50LnNyYyA9IGRhdGEubGluaztcclxuXHJcbiAgICBpZiAoZGF0YS5pc0xpa2VkKSB7XHJcbiAgICAgICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGlmIChjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKSkge1xyXG4gICAgICAgICAgICBhcGkudG9nZ2xlTGlrZShkYXRhLl9pZCwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGNhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYXBpLnRvZ2dsZUxpa2UoZGF0YS5faWQsIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oY2FyZExpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YS5faWQpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNhcmREZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGhhbmRsZURlbGV0ZUJ0bihjYXJkRWxlbWVudCwgZGF0YS5faWQpKTtcclxuXHJcbiAgICBpbWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gICAgICAgIHByZXZpZXdJbWcuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHByZXZpZXdJbWcuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgICAgIHByZXZpZXdDYXAudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcblxyXG5cclxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGVkaXRQcm9maWxlTmFtZS52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gICAgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbi52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICAgIHJlc2V0VmFsaWRhdGlvbihlZGl0TW9kYWwsIFtlZGl0UHJvZmlsZU5hbWUsIGVkaXRQcm9maWxlRGVzY3JpcHRpb25dKTtcclxuICAgIG9wZW5Nb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcclxufSk7XHJcblxyXG5wcm9maWxlQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdEZvcm1TdWJtaXQpO1xyXG5jYXJkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQXZhdGFyU3VibWl0KTtcclxuXHJcbmFkZENhcmROZXdQb3N0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICBvcGVuTW9kYWwoYWRkQ2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5hZGRDYXJkQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNsb3NlTW9kYWwoYWRkQ2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5kZWxldGVDYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59KTtcclxuXHJcbmF2YXRhck1vZGFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuXHJcbmF2YXRhckNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxufSlcclxuXHJcbnByZXZpZXdNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbn0pO1xyXG5cclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJcclxuY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0QXBwSW5mbygpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0LFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVkaXRBdmF0YXJJbmZvKGF2YXRhcikge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBhdmF0YXJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVDYXJkKGNhcmQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgICAgICBsaW5rLFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUxpa2UoaWQsIGlzTGlrZWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTsiXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJlcnJvck1zZ0lEIiwiaWQiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJkaXNhYmxlQnV0dG9uIiwiYnV0dG9uIiwiY29uZmlnIiwiZGlzYWJsZWQiLCJhZGQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsIiwiZW5hYmxlQnV0dG9uIiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsInNldEJ1dHRvblRleHQiLCJidG4iLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImRlZmF1bHRUZXh0IiwicHJvZmlsZUVkaXRCdG4iLCJkb2N1bWVudCIsImVkaXRQcm9maWxlTW9kYWwiLCJwcm9maWxlQ2xvc2VCdG4iLCJlZGl0TW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJhZGRDYXJkTmV3UG9zdCIsImFkZENhcmRDbG9zZUJ0biIsImNhcmRGb3JtIiwiY2FyZFN1Ym1pdEJ1dHRvbiIsImNhcmROYW1lSW5wdXQiLCJjYXJkTGlua0lucHV0IiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJlZGl0UHJvZmlsZU5hbWUiLCJlZGl0UHJvZmlsZURlc2NyaXB0aW9uIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJNb2RhbEJ0biIsImF2YXRhckNsb3NlQnRuIiwiYXZhdGFyRm9ybSIsImF2YXRhcklucHV0IiwiZWRpdEZvcm1FbGVtZW50IiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0IiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsQ2xvc2VCdG4iLCJwcmV2aWV3SW1nIiwicHJldmlld0NhcCIsImRlbGV0ZU1vZGFsIiwiZGVsZXRlQ2FuY2VsQnRuIiwiZGVsZXRlU3VibWl0Rm9ybSIsInNlbGVjdENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImdldEVsZW1lbnRCeUlkIiwic3JjIiwiaGVhZGVyU3JjIiwiYXZhdGVySW1nIiwiYXZhdGFyU3JjIiwicGVuY2lsU3JjIiwicGx1c1NyYyIsImxpZ2h0UGVuY2lsIiwiYXBpIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJlZGl0VXNlckluZm8iLCJfcmVmMiIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJyZW1vdmVDYXJkIiwiY2FyZCIsImFkZENhcmQiLCJfcmVmMyIsImxpbmsiLCJ0b2dnbGVMaWtlIiwiaXNMaWtlZCIsImF1dGhvcml6YXRpb24iLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVPdmVybGF5IiwiaGFuZGxlRXNjYXBlIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudCIsImtleSIsIm1vZGFsT3BlbmVkIiwidGFyZ2V0IiwiY29udGFpbnMiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsZW1lbnQiLCJpbWdFbGVtZW50IiwiY2FyZExpa2VCdG4iLCJjYXJkRGVsZXRlQnRuIiwiYWx0IiwiX2lkIiwidG9nZ2xlIiwiY29uc29sZSIsImxvZyIsImNhcmRJZCIsImhhbmRsZURlbGV0ZUJ0biIsImV2dCIsInN0b3BQcm9wYWdhdGlvbiIsImNhcmRzIiwidXNlcnMiLCJmb3JFYWNoIiwiaXRlbSIsInByZXBlbmQiLCJjYXRjaCIsImVycm9yIiwiZGVsZXRlU3VibWl0QnRuIiwic3VibWl0dGVyIiwicHJldmVudERlZmF1bHQiLCJmaW5hbGx5IiwicmVzZXRWYWxpZGF0aW9uIiwidmFsdWUiLCJlZGl0Rm9ybVN1Ym1pdEJ0biIsImFkZENhcmRTdWJtaXRCdG4iLCJjYXJkRGF0YSIsImNhcmRFbCIsInJlbmRlckNhcmQiLCJhdmF0YXJTdWJtaXRCdG4iLCJhdmF0YXJEYXRhIiwicXVlcnlTZWxlY3RvckFsbCIsInNldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwiYnV0dG9uRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJ2YWxpZGF0aW9uTWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=